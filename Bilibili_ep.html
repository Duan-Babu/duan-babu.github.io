<!DOCTYPE html>
<html>
<head>
    <title>å“”å“©åˆ†äº«å§¬</title>
    <meta name="referrer" content="no-referrer" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" href="https://www.bilibili.com/favicon.ico?v=1" />
    <link rel="stylesheet" href="https://cdn.staticfile.org/mdui/1.0.2/css/mdui.min.css" />
    <link rel="stylesheet" href="https://cdn.staticfile.org/limonte-sweetalert2/11.6.5/sweetalert2.min.css" />
    <script src="https://cdn.staticfile.org/mdui/1.0.2/js/mdui.min.js"></script>
    <script src="https://cdn.staticfile.org/limonte-sweetalert2/11.6.5/sweetalert2.min.js"></script>
    <script src="https://cdn.staticfile.org/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/qrcode-generator/1.4.4/qrcode.min.js"></script>
<script src="https://cdn.bootcss.com/limonte-sweetalert2/8.11.8/sweetalert2.min.js"></script>
<link href="https://cdn.bootcss.com/limonte-sweetalert2/8.11.8/sweetalert2.min.css" rel="stylesheet">

    <style>
        body {
            background-color: #eef1f5;
        }
        .responsive-video {
                width: 1048576px;
                height: 640px;
            }
            .mdui-card {
    border-radius: 12px;
    }

    .mdui-dialog {
        border-radius: 12px;
    }

    .mdui-btn-block {
        border-radius: 12px;
    }

    .mdui-btn {
        border-radius: 12px;
    }

    .mdui-video-fluid {
        border-radius: 12px;
    }

    .mdui-menu-open {
        border-radius: 12px;
    }

    .mdui-table-fluid {
        border-radius: 12px;
    }

    .mdui-panel-item {
        border-radius: 12px;
    }

    .mdui-toolbar {
        height: 64px;
        line-height: 64px;
    }

    .mdui-btn,
    .mdui-fab {
        text-transform: none;
    }

    .mdui-appbar .mdui-toolbar {
        height: 64px;
        line-height: 64px;
    }

    .mdui-appbar-with-toolbar {
        padding-top: 64px;
    }

    .mdui-overlay {
        backdrop-filter: blur(7px);
    }

    .mdui-card {
        box-shadow: 0 2px 2px 0 rgb(0 0 0 / 16%), 0 1px 5px 0 rgb(0 0 0 / 16%);
    }

    .mdui-drawer {
        box-shadow: -1px 10px 10px 0 rgb(60 64 67/30%), 0 1px 3px 1px rgb(60 64 67/15%);
    }
    </style>
</head>
<body class="mdui-appbar-with-toolbar mdui-theme-primary-indigo mdui-theme-accent-indigo">
    <header class="mdui-appbar mdui-appbar-fixed">
        <div class="mdui-toolbar mdui-color-theme">
            <button mdui-drawer="{target:'#MainDrawer'}" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content:'èœå•'}">
                <i class="mdui-icon material-icons">&#xe5d2;</i>
            </button>
            <a href="./" class="mdui-typo-headline" mdui-tooltip="{content:'ç‚¹å‡»è·³è½¬åˆ°å“”å“©åˆ†äº«å§¬ä»‹ç»é¡µé¢'}">å“”å“©åˆ†äº«å§¬</a>
            <div class="mdui-toolbar-spacer"></div>
            <button class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: 'æ·±è‰²æ ·å¼åˆ‡æ¢', position: 'left'}" id="DarkStyle"><i class="mdui-icon material-icons">brightness_4</i></button>
        </div>
        </div>
    </header>
    <nav class="mdui-drawer mdui-drawer-full-height mdui-drawer-close" id="MainDrawer">
        <ul class="mdui-list">
            <a id="ToggleHome" class="mdui-list-item" style="border-radius: 0px">
                <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-indigo">home</i>
                <div class="mdui-list-item-content">é¦–é¡µ</div>
            </a>

            <a id="ToggleAPPS" class="mdui-list-item" style="border-radius: 0px">
                <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-green">apps</i>
                <div class="mdui-list-item-content">è½¯ä»¶ä¸‹è½½</div>
            </a>

            <a id="ToggleWeb" class="mdui-list-item" style="border-radius: 0px">
                <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-brown">web</i>
                <div class="mdui-list-item-content">ç½‘é¡µç‰ˆ</div>
            </a>

            <a id="ToggleTutorial" class="mdui-list-item" style="border-radius: 0px">
                <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-deep-purple">book</i>
                <div class="mdui-list-item-content">æ•™ç¨‹</div>
            </a>

            <div class="mdui-divider"></div>

            <a id="ToggleGroup" class="mdui-list-item" style="border-radius: 0px">
                <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">person_add</i>
                <div class="mdui-list-item-content">äº¤æµç¾¤</div>
            </a>

            <div class="mdui-divider"></div>

            <a id="ToggleTOS" class="mdui-list-item" style="border-radius: 0px">
                <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-teal">import_contacts</i>
                <div class="mdui-list-item-content">æœåŠ¡æ¡æ¬¾</div>
            </a>

            <div class="mdui-divider"></div>

            <li class="mdui-list-item" mdui-drawer-close="{target:'#main-drawer'}" style="border-radius: 0px">
                <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue-grey">chevron_left</i>
                <div class="mdui-list-item-content">æ”¶èµ·èœå•</div>
            </li>
        </ul>
    </nav>
    <div id="Home">
        <div class="mdui-container mdui-p-t-3">
            <div class="mdui-col">
                <div class="mdui-card">
                    <div class="mdui-card-primary">
                        <div class="mdui-card-primary-title">âœ¨æ¬¢è¿ä½¿ç”¨å“”å“©åˆ†äº«å§¬~( â€¢Ì€ Ï‰ â€¢Ì )âœ§</div>
                        <div class="mdui-card-primary-subtitle">ğŸš«ä»¥ä¸‹å†…å®¹æ¥è‡ªå“”å“©å“”å“©ï¼Œç¦æ­¢è½¬è½½å’Œä¸‹è½½</div>  
                        <div class="mdui-card-primary-subtitle" id="ep">âŒå½“å‰ä¸ºepåˆ†äº«æ¨¡å¼ï¼Œepå·ä¸ºç©ºï¼Œæ— æ³•è§£æï¼è¯·è”ç³»åˆ†äº«è€…å¤„ç†</div> 
                    </div>
                </div>
                <br>
                <div class="mdui-card">
                    <video id="video" controls="controls" class="mdui-video-fluid"></video>
                </div>
                <br>
                <div class="mdui-card">
                    <div class="mdui-card-primary">
                        <div class="mdui-card-primary-title">è§†é¢‘åˆ†äº«</div>
                        <div class="mdui-card-primary-subtitle" id="ç”¨æˆ·ç±»åˆ«">æ¥è‡ª åŒ¿åç”¨æˆ· çš„åˆ†äº«</div>  
                            <div class="mdui-chip">
                              <img class="mdui-chip-icon" id="UserImage" src=""/>
                              <span class="mdui-chip-title" id="UserName">åŒ¿åç”¨æˆ·</span>
                            </div>  
                        <br/>
                        <div class="mdui-card-content">
                            <div class="mdui-row">
                                <div class="mdui-col-sm-2 mdui-col-xs-4">
                                    <div class="mdui-card-primary-subtitle">å…³æ³¨</div>
                                    <div class="mdui-card-primary-title" id="follow">0</div>
                                </div>
                                <div class="mdui-col-sm-2 mdui-col-xs-4">
                                    <div class="mdui-card-primary-subtitle">ç²‰ä¸</div>
                                    <div class="mdui-card-primary-title" id="fans">0</div>
                                </div>
                                <div class="mdui-col-sm-2 mdui-col-xs-4">
                                    <div class="mdui-card-primary-subtitle">ç­‰çº§</div>
                                    <div class="mdui-card-primary-title" id="level">0</div>
                                </div>
                            </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="mdui-m-t-2 mdui-text-center mdui-typo">
        <p>2023 ç”± <a style="font-weight: 600" href="https://babu.fanmao.pro">Babu</a> å¼€å‘ï¼Œç”± <a style="font-weight: 600" href="https://api.xingzhige.com/">æ˜Ÿä¹‹é˜API</a> æ”¯æŒï¼Œç‰ˆæƒå½’ <a style="font-weight: 600" href="https://www.bilibili.com">å“”å“©å“”å“©</a> æ‰€æœ‰ </p>
    </div>
  <script>
    // è·å–åœ°å€æ ä¸­çš„é“¾æ¥å‚æ•°
    function getUrlParameter() {
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const epId = urlParams.get('ep_id');
        if (epId) {
            // æ‰§è¡Œç›¸åº”çš„ä»£ç 
            document.getElementById('ep').textContent='âœ”ï¸å½“å‰ä¸ºepåˆ†äº«æ¨¡å¼ [' + epId +']';
        } 
        const accessKey = urlParams.get('access_key');
        const Usermid = urlParams.get('mid');
        return {
            epId: epId ? decodeURIComponent(epId) : '',
            accessKey: accessKey ? decodeURIComponent(accessKey) : '',
            Usermid: Usermid ? decodeURIComponent(Usermid) : '',
        };
    }

    // æ„å»ºè¯·æ±‚å¤´
    const headersHome = new Headers();
    headersHome.append('Referer', 'https://www.bilibili.com');

    // æ„å»ºè¯·æ±‚é…ç½®
    const requestConfigHome = {
    method: 'GET',
    headers: headersHome
    };

    // æ„å»ºè¯·æ±‚å¤´
    const headersUP = new Headers();
    headersUP.append('Referer', 'https://space.bilibili.com/' );

    // æ„å»ºè¯·æ±‚é…ç½®
    const requestConfigUP = {
    method: 'GET',
    headers: headersUP
    };

    // ä¸‹è½½ JSON æ•°æ®å¹¶è§£æå…¶ä¸­çš„ URL
    function downloadAndParseJson(url) {
      fetch(url,requestConfigHome)
        .then(response => response.json())
        .then(data => {
          const videoUrl = data.data.url;
          playVideo(videoUrl);
        })
        .catch(error => console.error('Error:', error));
    }

    // ä¸‹è½½ JSON æ•°æ®å¹¶è§£æå…¶ä¸­çš„ URLï¼ˆç”¨æˆ·ï¼‰
    function downloadAndParseJsonU(Userurl) {
      fetch(Userurl,requestConfigHome)
        .then(response => response.json())
        .then(data => {
          const UserName = data.data.owner.name;
          document.getElementById('UserImage').src=data.data.owner.face;
          document.getElementById('UserName').textContent=UserName;
          document.getElementById('ç”¨æˆ·ç±»åˆ«').textContent='æ¥è‡ª ' + data.data.owner.title_array.vip + ' çš„åˆ†äº«';
          document.getElementById('follow').textContent=data.data.fans.following;
          document.getElementById('fans').textContent=data.data.fans.follower;
          document.getElementById('level').textContent=data.data.owner.level;
          const titleElement = document.querySelector('title');
          titleElement.textContent = 'å“”å“©åˆ†äº«å§¬ | ' + UserName;
        })
        .catch(error => console.error('Error:', error));
    }
    
    // æ’­æ”¾è§†é¢‘
    function playVideo(videoUrl) {
      const video = document.getElementById('video');
      video.src = videoUrl;
      video.play();
    }

    // ä¸»å‡½æ•°
    function main() {
        var isWechat= (function(){
        return navigator.userAgent.toLowerCase().indexOf('micromessenger') !== -1
        }
        )();
        if(isWechat){
            Swal.fire(
            'ğŸ”’è®¿é—®å—é™',
            'æ‚¨æ­£åœ¨ä½¿ç”¨å¾®ä¿¡æµè§ˆé¡µé¢<br>âš ï¸è¯·åœ¨æµè§ˆå™¨è®¿é—®',
            'error'
            )
        }else {
            Swal.fire(
            'å¸¸è§„æ¨¡å¼',
            'è¯·ç¨åï¼Œèµ„æºæ­£åœ¨åŠ è½½ä¸­',
            'success'
            ) 
        }
        const urlParameter = getUrlParameter();
        if (urlParameter && urlParameter.epId && urlParameter.accessKey) {
            const url = 'https://api.xingzhige.com/API/b_bangumi/?ep_id=' + urlParameter.epId + '&access_key=' + urlParameter.accessKey;
            const userurl= 'https://api.xingzhige.com/API/b_personal/?mid=' + urlParameter.Usermid;
            downloadAndParseJson(url);
            downloadAndParseJsonU(userurl);
        } else {
            console.error('URL å‚æ•°ç¼ºå¤±');
        }
        }
        // æ‰§è¡Œä¸»å‡½æ•°
        main();
  </script>
  <script src="https://jessegary.github.io/media/js/modify.js"></script>
</body>
</html>